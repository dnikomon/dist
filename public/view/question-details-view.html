<!-- Question details or add new question container --><div><ul class="breadcrumb"><li><a ui-sref="secured.main">{{ 'QUESTIONS' | translate }}</a></li><li>{{ 'QUESTION' | translate }} #{{ questionInfo.ID }}</li></ul></div><div class="box" xmlns="http://www.w3.org/1999/html"><div class="box-inner"><div class="box-header well"><h2><i class="glyphicon glyphicon-repeat gly-spin" ng-show="isLoading.question"></i> <i class="glyphicon glyphicon-ok" ng-show="!isLoading.question"></i>&nbsp; <span>{{ 'QUESTION_TITLE_1' | translate }} {{ questionInfo.NAME }} {{ 'QUESTION_TITLE_2' | translate }}</span></h2></div><div class="box-content"><div class="row settings-row"><div class="col-sm-4 creation-info">{{ 'CREATED' | translate }}: {{ questionInfo.USER_CREATED }} {{ questionInfo.CREATED_AT | date:'dd.MM.yyyy HH:mm' }}</div><div class="col-sm-4 creation-info">{{ 'EDITED' | translate }}: {{ questionInfo.USER_EDITED }} {{ questionInfo.EDITED_AT | date:'dd.MM.yyyy HH:mm' }}</div></div><div class="row"><div class="col-md-12"><!-- Question information --><form class="form-horizontal" role="form"><div class="row"><div class="col-md-12"><div class="form-group"><label class="col-md-2 control-label" for="question-name" ng-if="!['SUBTITLE'].includes(questionInfo.TYPE)">{{ 'QUESTION_NAME' | translate }}:</label><label class="col-md-2 control-label" for="question-name" ng-if="['SUBTITLE'].includes(questionInfo.TYPE)">{{ 'SUBTITLE' | translate }}:</label><div class="col-md-4"><input type="text" class="form-control" id="question-name" ng-model="questionInfo.NAME" maxlength="100"></div><label class="col-md-2 control-label" for="question-id">ID:</label><div class="col-md-4"><input type="text" class="form-control" id="question-id" ng-model="questionInfo.ID" maxlength="100" ng-disabled="disabledID"></div></div><div class="form-group"><label class="col-md-2 control-label" for="question-text" ng-if="!['SUBTITLE'].includes(questionInfo.TYPE)">{{ 'QUESTION_TEXT' | translate }}:</label><label class="col-md-2 control-label" for="question-text" ng-if="['SUBTITLE'].includes(questionInfo.TYPE)">{{ 'SUBTITLE_TEXT' | translate }}:</label><div class="col-md-10"><div text-angular="text-angular" name="questiontext" id="question-text" ng-model="questionInfo.QUESTIONTEXT" ta-disabled="disabled"></div></div></div><div class="form-group" ng-if="!['FEEDBACK', 'TERMINUS'].includes(questionInfo.TYPE)"><label class="col-md-2 control-label" for="additional-text">{{ 'INSTRUCTION_TEXT' | translate }}:</label><div class="col-md-10"><div text-angular="text-angular" name="additionaltext" id="additional-text" ng-model="questionInfo.ADDITIONALTEXT" ta-disabled="disabled"></div></div></div><div class="form-group"><label class="col-md-2 control-label" for="question-description">{{ 'DESCRIPTION' | translate }}:</label><div class="col-md-10"><textarea class="form-control" id="question-description" ng-model="questionInfo.DESCRIPTION" maxlength="250"></textarea></div></div><div class="form-group"><label class="col-md-2 control-label" for="question-approver">{{ 'APPROVER' | translate }}:</label><div class="col-md-4"><input type="text" class="form-control" id="question-approver" ng-model="questionInfo.USER_APPROVED" ng-disabled="disabledApproval"></div></div><hr><div class="form-group" ng-repeat="(codeKey, code) in questionInfo.CODES"><label class="col-md-2 control-label" for="question-code-{{codeKey}}-system">{{ 'CODE_CLASSIFICATION' | translate }}:</label><div class="col-md-2"><select class="form-control detail-input" id="question-code-{{codeKey}}-system" ng-model="code.SYSTEM_ID" ng-disabled="code.ID !== undefined" convert-to-number><option ng-repeat="system in codeSystems" value="{{system.ID}}">{{system.NAME}}</option></select></div><label class="col-md-2 control-label" for="question-code-{{codeKey}}-value">{{ 'CODE' | translate }}:</label><div class="col-md-2"><input type="text" class="form-control" id="question-code-{{codeKey}}-value" ng-model="code.VALUE" ng-readonly="code.ID !== undefined" list="system-{{code.SYSTEM_ID}}-codes"></div><div class="col-md-2"><button type="button" class="btn btn-sm btn-default" ng-click="removeQuestionCode(code.ID, codeKey)">{{ 'REMOVE' | translate }}</button></div></div><div class="form-group"><div class="col-md-2 col-md-offset-2"><button type="button" class="btn btn-sm btn-blue" ng-click="addQuestionCode()">{{ 'ADD_CODE' | translate }}</button></div></div><hr><div class="form-group"><label class="col-sm-2 control-label" for="organisation">{{ 'ORGANIZATION' | translate }}:</label><div class="col-sm-3"><input type="text" class="form-control detail-input" id="organisation" ng-model="organizationList" ng-disabled="true"></div><div class="col-sm-1"><button type="button" class="btn btn-default btn-sm btn-blue" ng-click="editOrganizations(questionInfo)">{{ 'EDIT' | translate }}</button></div></div><div class="form-group" ng-if="questionID"><label class="col-md-2 control-label">{{ 'QUESTION_TYPE' | translate }}:</label><div class="col-md-10 radio"><label class="radio-inline" ng-repeat="type in questionTypes track by $index"><input id="question-type" id="{{ type.type }}" type="radio" name="typeradio" ng-model="$parent.$parent.questionInfo.TYPE" value="{{ type.type }}" ng-click="setAnswerText()">{{ type.text }}</label></div></div><div class="form-group" ng-if="questionInfo.TYPE=='CHECK' || questionInfo.TYPE=='SELECT'"><label class="col-md-2 control-label">{{ 'ADD_NONE_OF_THE_ABOVE' | translate }}:</label><div class="col-md-10 radio" style="margin-top:15px"><input type="checkbox" ng-model="questionInfo.NONE_ANSWER" ng-true-value="'Y'" ng-false-value="''"> {{ 'ADD_NONE_OF_THE_ABOVE2' | translate }}</div></div><!-- Save & return buttons --><div class="row"><div class="col-md-12"><button ng-hide="readonlymode" id="save-question-button" type="button" class="btn btn-default btn-sm btn-blue" ng-click="saveQuestion()">{{ 'SAVE' | translate }}<span ng-if="forms.length > 0"> ({{ 'USED_IN_FORMS1' | translate }} {{ forms.length }} {{ 'USED_IN_FORMS2' | translate }})</span></button> <button type="button" id="return-home-button" class="btn btn-default btn-sm btn-white" ng-click="goHome()">{{ 'RETURN_HOMEPAGE' | translate }}</button> <button ng-hide="readonlymode" type="button" id="delete-question-button" class="btn btn-default btn-sm btn-danger pull-right" ng-click="deleteQuestion()">{{ 'DELETE' | translate }}</button></div></div></div></div></form></div></div></div></div></div><!-- Container for answers --><div class="box"><div class="box-inner"><div class="box-header"><h2 ng-if="!['SUBTITLE'].includes(questionInfo.TYPE)"><i class="glyphicon glyphicon-repeat gly-spin" ng-show="isLoading.answers"></i>&nbsp; <i class="glyphicon glyphicon-ok" ng-show="!isLoading.answers"></i>&nbsp; {{ 'ANSWER_OPTIONS' | translate }}</h2></div><div class="box-content"><div class="row"><div class="col-md-12"><!-- Question type changed, not yet saved --><div class="row" ng-if="questionID > 0 && (questionInfo.TYPE != oldQuestionInfo.TYPE && !((questionInfo.TYPE === 'SELECT' || questionInfo.TYPE === 'CHECK') && (oldQuestionInfo.TYPE === 'SELECT' || oldQuestionInfo.TYPE === 'CHECK' )))"><div class="col-md-12"><p>{{ 'SAVING_INSTRUCTIONS' | translate }}</p></div></div><!-- Number value answer --><div ng-hide="readonlymode" class="row" ng-if="questionID > 0 && (questionInfo.TYPE === 'NUMBER' && oldQuestionInfo.TYPE == questionInfo.TYPE)"><form class="form-horizontal" role="form"><div class="col-md-12"><p class="saving-text" ng-class="savingInfo.value">{{ savingInfo.text }}</p><div class="form-group"><label class="col-md-3 col-xs-12 control-label" for="minimum">{{ 'MINIMUM_VALUE' | translate }}:</label><div class="col-sm-3 col-xs-12"><input type="number" class="form-control" id="minimum" maxlength="100" ng-model="answers[0].MIN"></div><label class="col-md-3 col-xs-12 control-label" for="maximum">{{ 'MAXIMUM_VALUE' | translate }}:</label><div class="col-sm-3 col-xs-12"><input type="number" class="form-control" id="maximum" maxlength="100" ng-model="answers[0].MAX"></div></div><div class="form-group"><label class="col-md-3 col-xs-12 control-label" for="maximum">{{ 'DECIMALS' | translate }}:</label><div class="col-sm-3 col-xs-12"><input type="number" min="0" step="1" class="form-control" id="decimals" maxlength="10" ng-model="answers[0].DECIMALS"></div><label class="col-md-3 col-xs-12 control-label" for="unit">{{ 'ANSWER_IN_UNIT' | translate }}:</label><div class="col-sm-3 col-xs-12"><select ng-model="answers[0].UNIT_ID" id="unit" ng-options="obj.value as obj.text for obj in Units" class="form-control"><option value="">-{{ 'CHOOSE' | translate }}-</option></select></div></div></div></form></div><!-- Multichoice answers --><div ng-hide="readonlymode" ng-if="questionID > 0 && ((questionInfo.TYPE === 'SELECT' || questionInfo.TYPE === 'CHECK') && (oldQuestionInfo.TYPE === 'SELECT' || oldQuestionInfo.TYPE === 'CHECK' ))" class="form form-horizontal"><div class="row operations-row"><!-- Add new choice --><div class="col-md-5"><div class="input-group input-group-sm"><input id="new-answer-text" type="text" class="form-control" ng-model="newAnswerText" maxlength="250" placeholder="{{ 'NEW_ANSWER_ENTRY' | translate }}"> <span class="input-group-btn"><button id="save-new-answer-button" type="button" class="btn btn-default btn-blue" ng-click="addAnswer(newAnswerText)">{{ 'ADD' | translate }}</button></span></div></div><!-- Remove & move up/down buttons --><div class="col-md-7"><button type="button" id="delete-answer-button" class="btn btn-default btn-sm btn-blue" ng-click="removeAnswer(selectedRow.value)" ng-disabled="!selectedRow.value">{{ 'REMOVE' | translate }}</button>&nbsp; <span class="tooltip-wrapper" tooltip="{{ tooltipMoveUp }}"><button type="button" id="move-answer-up-button" class="btn btn-default btn-sm" ng-click="moveUp(selectedRow.value)" ng-disabled="isLoading.answers || !selectedRow.value"><i class="glyphicon glyphicon-arrow-up"></i></button> </span>&nbsp; <span class="tooltip-wrapper" tooltip="{{ tooltipMoveDown }}"><button type="button" id="move-answer-down-button" class="btn btn-default btn-sm" ng-click="moveDown(selectedRow.value)" ng-disabled="isLoading.answers || !selectedRow.value"><i class="glyphicon glyphicon-arrow-down"></i></button></span><p class="saving-text" ng-class="savingInfo.value">{{ savingInfo.text }}</p></div></div><div ng-repeat="(answerKey, answer) in answers track by $index"><div class="form-group"><div class="col-md-12"><div class="input-group input-group-sm"><span class="input-group-addon"><input type="radio" id="answer-radio-button" name="selectedChoice" ng-model="$parent.selectedRow.value" value="{{ answer.ID }}"> </span><span class="input-group-addon">ID:{{ answer.ID }} </span><span class="input-group-addon">{{ 'ANSWER' | translate }}: </span><input type="text" class="form-control" ng-model="answer.ANSWER_TEXT" maxlength="250"> <span class="input-group-addon">{{ 'ANSWER_VALUE' | translate }}: </span><input type="text" class="form-control" ng-model="answer.ANSWER_VALUE" maxlength="250"></div></div></div><div class="form-group" ng-repeat="(codeKey, code) in answer.CODES"><label class="col-md-2 control-label" for="answer-{{answerKey}}-code-{{codeKey}}-system">{{ 'CODE_CLASSIFICATION' | translate }}:</label><div class="col-md-2"><select class="form-control detail-input" id="answer-{{answerKey}}-code-{{codeKey}}-system" ng-model="code.SYSTEM_ID" ng-disabled="code.ID !== undefined" convert-to-number><option ng-repeat="system in codeSystems" value="{{system.ID}}">{{system.NAME}}</option></select></div><label class="col-md-2 control-label" for="answer-{{answerKey}}-code-{{codeKey}}-value">{{ 'CODE' | translate }}:</label><div class="col-md-2"><input type="text" class="form-control" id="answer-{{answerKey}}-code-{{codeKey}}-value" ng-model="code.VALUE" ng-readonly="code.ID !== undefined" list="system-{{code.SYSTEM_ID}}-codes"></div><div class="col-md-2"><button type="button" class="btn btn-sm btn-default" ng-click="removeAnswerCode(answer.ID, code.ID, codeKey)">{{ 'REMOVE' | translate }}</button></div><div class="col-md-2" ng-if="codeKey === answer.CODES.length - 1"><button type="button" class="btn btn-sm btn-blue" ng-click="addAnswerCode(answer.ID)">{{ 'ADD_CODE' | translate }}</button></div></div><div class="form-group" ng-if="answer.CODES.length === 0"><div class="col-md-2 col-md-offset-10"><button type="button" class="btn btn-sm btn-blue" ng-click="addAnswerCode(answer.ID)">{{ 'ADD_CODE' | translate }}</button></div></div></div></div><!-- New question, cannot enter choices before saving --><div class="col-md-12" ng-if="!questionID"><p>{{ 'SAVE_BEFORE_OPTIONS' | translate }}</p></div><!-- QUESTION PREVIEW --><h4 class="operations-row">{{ 'PREVIEW' | translate }}</h4><!-- Yes/no answers --><div class="form-group" ng-if="questionID > 0 && (questionInfo.TYPE === 'YESNO' && oldQuestionInfo.TYPE == questionInfo.TYPE)"><label class="col-sm-3 control-label" ng-bind-html="questionInfo.QUESTIONTEXT"></label><div class="radio"><label class="radio-inline"><input type="radio">{{ 'YES' | translate }}</label><label class="radio-inline"><input type="radio">{{ 'NO' | translate }}</label></div></div><!-- Number/text value --><div class="form-group" ng-if="questionID > 0 && ((questionInfo.TYPE === 'NUMBER' || questionInfo.TYPE === 'TEXT') && oldQuestionInfo.TYPE == questionInfo.TYPE)"><label class="col-sm-3 control-label" ng-bind-html="questionInfo.QUESTIONTEXT"></label><div class="col-sm-3"><input type="text" class="form-control" placeholder="{{ 'ANSWERTEXT' | translate }}"></div></div><!-- Date value --><div class="form-group" ng-if="questionID > 0 && ((questionInfo.TYPE === 'DATE') && oldQuestionInfo.TYPE == questionInfo.TYPE)"><label class="col-sm-3 control-label" ng-bind-html="questionInfo.QUESTIONTEXT"></label><div class="col-sm-3"><div class="input-group input-group-sm"><input ng-model="NotInUse" type="text" class="form-control detail-input" placeholder="{{ 'ANSWERDATE' | translate }}" datepicker-popup="dd.MM.yyyy" datepicker-options="calendarOptions" is-open="calendar1Open" starting-day="1" close-text="Sulje" current-text="Tänään" clear-text="Tyhjennä"> <span class="input-group-btn"><button type="button" class="btn btn-default" id="openStartDate" ng-click="openStartDateCalendar($event)"><i class="glyphicon glyphicon-calendar"></i></button></span></div></div></div><!-- Text value --><div class="form-group" ng-if="questionID > 0 && (questionInfo.TYPE === 'TEXTAREA' && oldQuestionInfo.TYPE == questionInfo.TYPE)"><label class="col-sm-3 control-label" ng-bind-html="questionInfo.QUESTIONTEXT"></label><div class="col-sm-5"><textarea class="form-control" placeholder="{{ 'ANSWERTEXT' | translate }}"></textarea></div></div><!-- Subtitle & Feedback & Terminus--><div class="form-group" ng-if="questionID > 0 && ['SUBTITLE', 'FEEDBACK', 'TERMINUS'].includes(questionInfo.TYPE) && oldQuestionInfo.TYPE == questionInfo.TYPE"><div class="col-sm-12"><h2 style="margin-top:10px">{{questionInfo.NAME}}</h2></div><div class="col-sm-12" ng-bind-html="questionInfo.QUESTIONTEXT"></div></div><!-- Multichoice --><div ng-if="questionID > 0 && (questionInfo.TYPE === 'SELECT' && (oldQuestionInfo.TYPE === 'SELECT' || oldQuestionInfo.TYPE === 'CHECK' ))"><div class="row"><label class="col-md-12" ng-bind-html="questionInfo.QUESTIONTEXT"></label></div><div class="col-md-10 radio" ng-repeat="answer in answers track by $index"><label><input type="radio">{{ answer.ANSWER_TEXT }}</label></div></div><div ng-if="questionID > 0 && (questionInfo.TYPE === 'CHECK' && (oldQuestionInfo.TYPE === 'SELECT' || oldQuestionInfo.TYPE === 'CHECK' ))"><div class="row"><label class="col-md-12" ng-bind-html="questionInfo.QUESTIONTEXT"></label></div><div class="col-md-10 checkbox" ng-repeat="answer in answers track by $index"><label><input type="checkbox">{{ answer.ANSWER_TEXT }}</label></div><div class="col-md-10 checkbox" ng-show="questionInfo.NONE_ANSWER"><label><input type="checkbox">{{ 'NONE_OF_THE_ABOVE' | translate }}</label></div></div></div></div></div></div></div><!-- Container for forms where question is used --><div class="box"><div class="box-inner"><div class="box-header"><h2><i class="glyphicon glyphicon-repeat gly-spin" ng-show="isLoading.answers"></i>&nbsp; <i class="glyphicon glyphicon-ok" ng-show="!isLoading.answers"></i>&nbsp; {{ 'USED_IN_FORMS' | translate }}</h2></div><div class="box-content"><div class="row"><ul><li ng-repeat="form in forms"><a id="form-name" ui-sref="secured.formDetailsPage({ formid: '{{form.ID}}' })"><i class="glyphicon glyphicon-chevron-right"></i>&nbsp;{{ form.NAME }} - <span style="font-style: italic">({{ 'REFERENCING_DISPLAY_LOGICS' | translate }}: {{form.DISPLAY_LOGICS}})</span></a></li></ul></div></div></div></div><datalist ng-repeat="(systemId, codes) in systemCodes" id="system-{{systemId}}-codes"><option ng-repeat="code in codes" value="{{code.VALUE}}"></option></datalist>